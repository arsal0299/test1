<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    .box { width: 400px; margin: auto; padding: 25px; background: white; border-radius: 8px; }
    input, select, button { width: 100%; padding: 10px; margin-top: 10px; }
    .credits { background: #007bff; color: white; padding: 10px; text-align: center; margin-bottom: 15px; border-radius: 6px; }
  </style>
</head>
<body>

<div class="box">
  <h2>Dashboard</h2>

  <div class="credits">
    Credits: <span id="credits">0</span>
  </div>

  <button onclick="earnCredits()">Watch Ad & Earn 10 Credits</button>

  <h3>Place Order</h3>
  <select id="service">
    <option value="1">Instagram Followers</option>
    <option value="2">Instagram Likes</option>
    <option value="3">YouTube Views</option>
  </select>

  <input id="link" placeholder="Paste link">
  <input id="qty" type="number" placeholder="Quantity">

  <button onclick="placeOrder()">Place Order</button>

  <button style="background:red;color:white" onclick="logout()">Logout</button>
</div>

<script>
let user = JSON.parse(localStorage.getItem("user"));
document.getElementById("credits").innerText = user.credits;

async function earnCredits() {
  let res = await fetch("https://myapi1-five.vercel.app/earn", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({userId: user.id})
  });

  let data = await res.json();
  alert(data.message);

  user.credits += 10;
  localStorage.setItem("user", JSON.stringify(user));
  document.getElementById("credits").innerText = user.credits;
}

async function placeOrder() {
  let service = document.getElementById("service").value;
  let link = document.getElementById("link").value;
  let quantity = document.getElementById("qty").value;

  let creditsUsed = quantity; // 1 quantity = 1 credit (example)

  let res = await fetch("https://myapi1-five.vercel.app/order", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      userId: user.id,
      service,
      link,
      quantity,
      creditsUsed
    })
  });

  let data = await res.json();
  alert("Order placed! ID: " + data.order_id);

  user.credits -= creditsUsed;
  localStorage.setItem("user", JSON.stringify(user));
  document.getElementById("credits").innerText = user.credits;
}

function logout() {
  localStorage.removeItem("user");
  window.location.href = "index.html";
}
</script>

</body>
</html>
